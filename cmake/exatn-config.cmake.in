# - Config file for ExaTN
# To point to your install of ExaTN, pass the
# EXATN_ROOT flag to your cmake configure.
#
# It defines the following variables
#  EXATN_INCLUDE_DIRS - include directories for XACC
#  EXATN_LIBRARIES    - libraries to link against
#  EXATN_LIBRARY_DIR  - the XACC library directory
include(CTest)
if (NOT EXATN_ROOT)
   get_filename_component(EXATN_ROOT "${CMAKE_CURRENT_LIST_FILE}" PATH)
endif()
set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} ${EXATN_ROOT}/share/exatn)
if (NOT TARGET format)
   include(format)
endif()
set (EXATN_LIBRARY_DIR "${EXATN_ROOT}/lib")
link_directories("${EXATN_ROOT}/lib")
set(EXATN_INCLUDE_ROOT "${EXATN_ROOT}/include")

set (EXATN_INCLUDE_DIRS "${EXATN_INCLUDE_ROOT}/cppmicroservices4;${EXATN_INCLUDE_ROOT}/exatn;${EXATN_INCLUDE_ROOT}/gtest")
set (EXATN_LIBRARIES "exatn;exatn-numerics;exatn-utility;CppMicroServices")

macro(exatn_add_test TESTNAME)
  add_executable(${TESTNAME} ${ARGN})
  target_link_libraries(${TESTNAME} PRIVATE gtest gmock gtest_main)
  add_test(${TESTNAME} ${TESTNAME})
  set_target_properties(${TESTNAME} PROPERTIES FOLDER tests)
endmacro()

macro(exatn_enable_rpath LIBNAME)
  if(APPLE)
    set_target_properties(${LIBNAME} PROPERTIES INSTALL_RPATH "@loader_path")
    set_target_properties(${LIBNAME} PROPERTIES LINK_FLAGS "-undefined dynamic_lookup")
  else()
    set_target_properties(${LIBNAME} PROPERTIES INSTALL_RPATH "$ORIGIN")
    set_target_properties(${LIBNAME} PROPERTIES LINK_FLAGS "-shared")
  endif()
endmacro()